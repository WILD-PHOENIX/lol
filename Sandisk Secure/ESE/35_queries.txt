-- Step 1: Create the database
CREATE DATABASE UGLA1;
USE UGLA1;

-- Step 2: Create tables with the given structures
CREATE TABLE DEPT (
    DEPTNO NUMERIC(2) PRIMARY KEY,
    DNAME VARCHAR(20) NOT NULL,
    LOC VARCHAR(10)
);

CREATE TABLE EMP (
    EMPNO NUMERIC(4) PRIMARY KEY,
    ENAME VARCHAR(20) NOT NULL,
    JOB CHAR(10),
    MGR NUMERIC(4),
    HIREDATE DATETIME,
    SAL NUMERIC(9, 2),
    COMM NUMERIC(7, 2),
    DEPTNO NUMERIC(2),
    FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO)
);

-- Step 3: Insert records into DEPT table
INSERT INTO DEPT VALUES (10, 'ACCOUNTING', 'NEW YORK');
INSERT INTO DEPT VALUES (20, 'RESEARCH', 'DALLAS');
INSERT INTO DEPT VALUES (30, 'SALES', 'CHICAGO');
INSERT INTO DEPT VALUES (40, 'OPERATIONS', 'BOSTON');

-- Step 4: Insert records into EMP table
INSERT INTO EMP VALUES (7369, 'SMITH', 'CLERK', 7902, '1980-12-17', 800, NULL, 20);
INSERT INTO EMP VALUES (7499, 'ALLEN', 'SALESMAN', 7698, '1981-02-20', 1600, 300, 30);
INSERT INTO EMP VALUES (7521, 'WARD', 'SALESMAN', 7698, '1981-02-22', 1250, 500, 30);
INSERT INTO EMP VALUES (7566, 'JONES', 'MANAGER', 7839, '1981-04-02', 2975, NULL, 20);
INSERT INTO EMP VALUES (7654, 'MARTIN', 'SALESMAN', 7698, '1981-09-28', 1250, 1400, 30);
INSERT INTO EMP VALUES (7698, 'BLAKE', 'MANAGER', 7839, '1981-05-01', 2850, NULL, 30);
INSERT INTO EMP VALUES (7782, 'CLARK', 'MANAGER', 7839, '1981-06-09', 2450, NULL, 10);
INSERT INTO EMP VALUES (7788, 'SCOTT', 'ANALYST', 7566, '1987-04-19', 3000, NULL, 20);
INSERT INTO EMP VALUES (7839, 'KING', 'PRESIDENT', NULL, '1981-11-17', 5000, NULL, 10);
INSERT INTO EMP VALUES (7844, 'TURNER', 'SALESMAN', 7698, '1981-09-08', 1500, 0, 30);
INSERT INTO EMP VALUES (7876, 'ADAMS', 'CLERK', 7788, '1987-05-23', 1100, NULL, 20);
INSERT INTO EMP VALUES (7900, 'JAMES', 'CLERK', 7698, '1981-12-03', 950, NULL, 30);
INSERT INTO EMP VALUES (7902, 'FORD', 'ANALYST', 7566, '1981-12-03', 3000, NULL, 20);
INSERT INTO EMP VALUES (7934, 'MILLER', 'CLERK', 7782, '1982-01-23', 1300, NULL, 10);

-- Step 5: 35 Queries

-- 1. SELECT ALL THE RECORDS FROM EMP TABLE
SELECT * FROM EMP;

-- 2. SELECT ALL THE RECORDS FROM DEPT TABLE
SELECT * FROM DEPT;

-- 3. FIND THE EMPLOYEE NAME, SALARY WHO IS WORKING IN DEPT NO 20
SELECT ENAME, SAL FROM EMP WHERE DEPTNO = 20;

-- 4. FIND THE NAME, JOB, SALARY OF THE EMPLOYEE WHO IS MANAGER
SELECT ENAME, JOB, SAL FROM EMP WHERE JOB = 'MANAGER';

-- 5. FIND THE NAME, JOB, SALARY OF THE EMPLOYEE WHO IS NOT A MANAGER
SELECT ENAME, JOB, SAL FROM EMP WHERE JOB != 'MANAGER';

-- 6. FIND THOSE EMPLOYEES WHO WERE HIRED BETWEEN 1 MAR 1981 AND 1 JUN 1983
SELECT ENAME FROM EMP WHERE HIREDATE BETWEEN '1981-03-01' AND '1983-06-01';

-- 7. FIND EMPLOYEE NAME WHO WERE HIRED IN 1981
SELECT ENAME FROM EMP WHERE YEAR(HIREDATE) = 1981;

-- 8. FIND EMPLOYEE NAME WHOSE NAME STARTS WITH ‘S’
SELECT ENAME FROM EMP WHERE ENAME LIKE 'S%';

-- 9. FIND EMPLOYEE NAME WHOSE NAME ENDS WITH ‘S’
SELECT ENAME FROM EMP WHERE ENAME LIKE '%S';

-- 10. FIND EMPLOYEE NAME WHO ARE WORKING IN DEPT NO 20 & 40
SELECT ENAME FROM EMP WHERE DEPTNO IN (20, 40);

-- 11. FIND ENAME, JOB AND DEPTNO WHO ARE CLERK & SALESMAN
SELECT ENAME, JOB, DEPTNO FROM EMP WHERE JOB IN ('CLERK', 'SALESMAN');

-- 12. FIND ENAME WHO ARE MANAGER AND GETTING SALARY MORE THAN 2000
SELECT ENAME FROM EMP WHERE JOB = 'MANAGER' AND SAL > 2000;

-- 13. FIND ENAME WHO ARE WORKING IN DEPTNO 30 ORDER BY SALARY IN DESC ORDER
SELECT ENAME FROM EMP WHERE DEPTNO = 30 ORDER BY SAL DESC;

-- 14. FIND OUT THE TOTAL SALARY OF ALL THE EMPLOYEES
SELECT SUM(SAL) AS TotalSalary FROM EMP;

-- 15. FIND OUT AVERAGE SALARY OF ALL THE EMPLOYEES WHO ARE WORKING IN DEPTNO 30
SELECT AVG(SAL) AS AvgSalary FROM EMP WHERE DEPTNO = 30;

-- 16. FIND OUT THE MINIMUM SALARY OF DEPT NO 20
SELECT MIN(SAL) AS MinSalary FROM EMP WHERE DEPTNO = 20;

-- 17. FIND OUT THE MAXIMUM HIREDATE
SELECT MAX(HIREDATE) AS LatestHireDate FROM EMP;

-- 18. FIND OUT THE TOTAL NUMBER OF EMPLOYEES WHO ARE WORKING IN DEPT NO 10
SELECT COUNT(*) AS TotalEmployees FROM EMP WHERE DEPTNO = 10;

-- 19. FIND OUT DEPTNO, TOTAL SALARY OF THOSE DEPT WHERE THERE IS NO SALESMAN AND TOTAL SALARY OF DEPT IS MORE THAN 8500
SELECT DEPTNO, SUM(SAL) AS TotalSalary 
FROM EMP WHERE JOB != 'SALESMAN' 
GROUP BY DEPTNO HAVING SUM(SAL) > 8500;

-- 20. FIND ENAME WHO WAS HIRED FIRST
SELECT ENAME FROM EMP WHERE HIREDATE = (SELECT MIN(HIREDATE) FROM EMP);

-- 21. FIND TOTAL SALARY FOR THOSE WHO ARE NOT MANAGER
SELECT SUM(SAL) AS TotalSalary FROM EMP WHERE JOB != 'MANAGER';

-- 22. FIND OUT JOB AND AVERAGE SALARY FOR ALL THE JOB TYPES WITH MORE THAN 2 EMPLOYEES
SELECT JOB, AVG(SAL) AS AvgSalary 
FROM EMP GROUP BY JOB HAVING COUNT(*) > 2;

-- 23. FIND OUT THE ENAME HAVING MAXIMUM SALARY IN EACH DEPT
SELECT ENAME, DEPTNO, SAL 
FROM EMP WHERE (DEPTNO, SAL) IN 
    (SELECT DEPTNO, MAX(SAL) FROM EMP GROUP BY DEPTNO);

-- 24. FIND THE SQUARE ROOT OF THE SALARY IN EMP TABLE
SELECT ENAME, SQRT(SAL) AS SalarySqrt FROM EMP;

-- 25. FIND AVG SALARY FOR THOSE EMPLOYEES WHOSE JOB = 'CLERK'
SELECT AVG(SAL) AS AvgClerkSalary FROM EMP WHERE JOB = 'CLERK';

-- 26. FIND TOTAL SALARY FOR THOSE EMPLOYEES WHO WERE HIRED IN 1981
SELECT SUM(SAL) AS TotalSalary FROM EMP WHERE YEAR(HIREDATE) = 1981;

-- 27. CHANGE THE JOB, DEPTNO, SALARY WHOSE EMPNO = 7788
UPDATE EMP SET JOB = 'SALESMAN', DEPTNO = 30, SAL = 2000 WHERE EMPNO = 7788;

-- 28. CREATE TABLE NEW USING ALL RECORDS FROM EMP
CREATE TABLE NEW AS SELECT * FROM EMP;

-- 29. CHANGE THE JOB OF TABLE NEW TO ‘SALES’
UPDATE NEW SET JOB = 'SALES';

-- 30. SELECT ALL RECORDS FROM NEW
SELECT * FROM NEW;

-- 31. ADD A NEW COLUMN ADDRESS VARCHAR(10) TO TABLE NEW
ALTER TABLE NEW ADD ADDRESS VARCHAR(10);

-- 32. INSERT THE VALUE TO ADDRESS COLUMN IN TABLE NEW
UPDATE NEW SET ADDRESS = 'NY';

-- 33. SELECT ALL RECORDS FROM NEW
SELECT * FROM NEW;

-- 34. UPDATE THE SIZE OF ADDRESS COLUMN FROM 10 TO 4
ALTER TABLE NEW MODIFY COLUMN ADDRESS VARCHAR(4);

-- 35. DELETE TABLE NEW
DROP TABLE NEW;
